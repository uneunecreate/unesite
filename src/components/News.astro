---
import { getCollection } from 'astro:content';

interface Props {
	lang?: string;
}

const { lang = 'ja' } = Astro.props;

const titleText = lang === 'ja' ? 'News' : 'News';

const allNews = await getCollection('news');
const publishedNews = allNews
	.filter(item => item.data.published)
	.sort((a, b) => b.data.date.getTime() - a.data.date.getTime());
---

<section id="news">
	<div class="container">
		<h2>{titleText}</h2>
		<div class="news-grid">
			{publishedNews.map((item) => (
				<article class="news-item">
					<div class="news-image">
						<img src={item.data.image} alt={lang === 'ja' ? item.data.title : item.data.titleEn} />
					</div>
					<div class="news-content">
						<time datetime={item.data.date.toISOString()}>
							{item.data.date.toLocaleDateString(lang === 'ja' ? 'ja-JP' : 'en-US', {
								year: 'numeric',
								month: 'long',
								day: 'numeric'
							})}
						</time>
						<h3>{lang === 'ja' ? item.data.title : item.data.titleEn}</h3>
						<p>{lang === 'ja' ? item.data.description : item.data.descriptionEn}</p>
					</div>
				</article>
			))}
		</div>
	</div>
</section>

<style>
	.container {
		max-width: var(--max-width);
		margin: 0 auto;
	}

	h2 {
		font-size: 48px;
		margin-bottom: calc(var(--spacing-unit) * 10);
		text-align: center;
		letter-spacing: -0.03em;
	}

	.news-grid {
		display: grid;
		gap: calc(var(--spacing-unit) * 10);
	}

	.news-item {
		display: grid;
		grid-template-columns: 1fr;
		gap: calc(var(--spacing-unit) * 5);
		padding-bottom: calc(var(--spacing-unit) * 10);
		border-bottom: 1px solid var(--color-border);
	}

	.news-item:last-child {
		border-bottom: none;
		padding-bottom: 0;
	}

	.news-image {
		overflow: hidden;
		border-radius: 2px;
	}

	.news-image img {
		width: 100%;
		height: 300px;
		object-fit: cover;
		display: block;
		transition: transform 0.4s ease;
	}

	.news-item:hover .news-image img {
		transform: scale(1.02);
	}

	.news-content time {
		display: block;
		font-size: 14px;
		opacity: 0.6;
		margin-bottom: calc(var(--spacing-unit) * 2);
	}

	.news-content h3 {
		font-size: 28px;
		margin-bottom: calc(var(--spacing-unit) * 2);
	}

	.news-content p {
		font-size: 16px;
		line-height: 1.8;
		margin: 0;
		opacity: 0.9;
	}

	@media (min-width: 768px) {
		h2 {
			font-size: 64px;
		}

		.news-item {
			grid-template-columns: 400px 1fr;
			gap: calc(var(--spacing-unit) * 6);
		}

		.news-image img {
			height: 100%;
			min-height: 300px;
		}
	}
</style>
